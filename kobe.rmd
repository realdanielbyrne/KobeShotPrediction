---
title: "Kobe Shot Predictor"
author: "Daniel Byrne"
date: "April 10, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
library(car)
library(relaimpo)
library(bootstrap)
layout(matrix(c(1,2,3,4),2,2))
library(aod)
library(ggplot2)
library(fmsb)
library(MASS)
```


```{r}
# read data
kobe = read.csv("./project2Data.csv")

# set factors
kobe$action_type = factor(kobe$action_type)
kobe$shot_type = factor(kobe$shot_type)
kobe$combined_shot_type = factor(kobe$combined_shot_type)
kobe$shot_zone_area = factor(kobe$shot_zone_area)
kobe$shot_zone_basic = factor(kobe$shot_zone_basic)
kobe$shot_zone_range = factor(kobe$shot_zone_range)
kobe$season = factor(kobe$season)
kobe$playoffs = factor(kobe$playoffs)
kobe$shot_made_flag = factor(kobe$shot_made_flag)
kobe$period = factor(kobe$period)
kobe$season = factor(kobe$season)
kobe$playoffs = factor(kobe$playoffs)
```

## 2 pt shot models
```{r}
## Filter to only 2 pt shots
kobe2pts = kobe %>% filter(shot_type == "2PT Field Goal" & shot_zone_area != "Back Court(BC)" & !shot_zone_basic %in% c("Right Corner 3","Left Corner 3","Above the Break 3"))
summary(kobe2pts)
```

### Shot type as a predictor
```{r}
twosTypes = glm(shot_made_flag ~ combined_shot_type, data =kobe2pts, family="binomial")
summary(twosTypes)
```

### Shot distance(y) as a predictor for 2 pt shots
```{r}
twosDist = glm(shot_made_flag ~   shot_zone_basic + loc_y, data = kobe2pts, family = "binomial" )
predictors = kobe2pts %>% dplyr::select(loc_y, shot_distance)
cor(predictors)
summary(twosDist)
```

### shot distance(x) as a predictor

```{r}
twosx = glm(shot_made_flag~ shot_zone_area + loc_x, data=kobe2pts,family="binomial")
summary(twosx)
```

## 3 points shots

```{r}

kobe3pts = kobe %>% filter(shot_type == "3PT Field Goal" & shot_zone_range  %in% c("24+ ft.","16-24 ft.") & shot_distance > 23)
summary(kobe3pts)
```

### 3pts predicted by distance(y)

```{r}
threesDist = glm(shot_made_flag ~ shot_distance, data = kobe3pts, family = "binomial" )
summary(threesDist)
```

### 3pts predicted by distance(x)

```{r}
threesDist1 = glm(shot_made_flag ~ loc_x + shot_zone_area, data = kobe3pts, family = "binomial" )
summary(threesDist1)
threesDist2 = glm(shot_made_flag ~ loc_x + shot_zone_basic, data = kobe3pts, family = "binomial" )
summary(threesDist2)
```

### 3pts by year

```{r}
threesDist1 = glm(shot_made_flag ~ season, data = kobe3pts, family = "binomial" )
summary(threesDist1)
```

## All Shots

### All Shots by Distance

LDA

```{r}
shotDistanceLda = lda(shot_made_flag ~  shot_zone_range + shot_zone_basic + loc_y, data = kobe,na.action="na.omit", CV=TRUE)
shotDistanceLda
```


### Logistic Shotdistance by zone range and zone basic

```{r}
shotDistance1 = glm(shot_made_flag ~  shot_zone_range + shot_zone_basic + loc_y, family = "binomial", data = kobe)
predictors = kobe2pts %>% dplyr::select(shot_zone_range, shot_zone_basic)
chisq.test(kobe$shot_zone_range,kobe$shot_zone_basic)
chisq.test(kobe$shot_zone_range,kobe$loc_y)
summary(shotDistance1)
```
### Logistic Shot Distance by shot distance
```{r}
shotDistance2 = glm(shot_made_flag ~  shot_zone_range + shot_zone_basic + loc_y, family = "binomial", data = kobe)
summary(shotDistance1)
```

## Project Questions

*The odds of Kobe making a shot decrease with respect to the distance he is from the hoop.  If there is evidence of this, quantify this relationship.  (CIs, plots, etc.)*

```{r}
shotDistance1 = glm(shot_made_flag ~  shot_distance, family = "binomial", data = kobe)
summary(shotDitance1)
```




*The probability of Kobe making a shot decreases linearly with respect to the distance he is from the hoop.    If there is evidence of this, quantify this relationship.  (CIs, plots, etc.)*

```{r}

*The relationship between the distance Kobe is from the basket and the odds of him making the shot is different if they are in the playoffs.  Quantify your findings with statistical evidence one way or the other. (Tests, CIs, plots, etc.)*
